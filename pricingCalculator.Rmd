---
title: "Product Pricing"
author: "Wes Horton"
date: "2023-11-24"
output:
  flexdashboard::flex_dashboard:
    orientation: rows
    runtime: shiny
    vertical_layout: scroll
    smooth_scroll: yes
---

```{r setup, include=FALSE}
#library(wrh.rUtils)
devtools::load_all("~/my_tool_repos/wrh.rUtils")
```

Column {.sidebar}
-----------------------------------------------------------------------

Enter a product's wholesale cost, shipping weight, and desired profit margin and receive the appropriate price.

```{r}
### Price
numericInput("price_v", label = "Wholesale Price",
             value = 10, min = 0)

### Shipping Weight and/or Pot Size
textInput("shippingWeight_v", label = "Shipping Weight",
            value = '', placeholder = '1, 2.5, 5, or 2in, 4in, 8in, etc.')

### Select supplier
selectInput("shop_v", label = "Supplier",
            choices = c("PlantBoy", "PlantShop"))

### Select margin
selectInput("margin_v", label = "Profit Margin",
            choices = seq(from = 0.1, to = 0.5, by = 0.01), selected = 0.36)

### Which method
selectInput("method_v", label = "Calculation Method",
            choices = c(1,2), selected = 1)

checkboxInput("includeShipping_v", label = "Include Shipping in Margin?", value = T)

```

Column
-----------------------------------------------------------------------

```{r}
renderPrint({
  profitMarginCalculator(price_v = as.numeric(input$price_v),
                         margin_v = as.numeric(input$margin_v),
                         shippingWeight_v = input$shippingWeight_v,
                         shop_v = as.character(input$shop_v),
                         includeShippingInMargin_v = as.logical(input$includeShipping_v),
                         method_v = as.numeric(input$method_v))
})
```